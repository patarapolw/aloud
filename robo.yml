# Commands

docker-build:
  command: |
    cd packages/web && yarn build && cd -
    docker build \
      -t {{.docker.tag.gcr}} \
      --build-arg FIREBASE_CONFIG \
      .
docker-start:
  command: |
    docker run \
      -p 8080:8080 \
      -e SECRET -e FIREBASE_SDK -e FIREBASE_CONFIG -e MONGO_URI -e ALOUD_SITE \
      {{.docker.tag.gcr}} 
docker-deploy:
  command: |
    docker push {{.docker.tag.gcr}}
dev:
  command: |
    concurrently \
      'cd packages/server && yarn dev' \
      'cd packages/web && yarn dev'

##########
# Settings

variables:
  docker:
    tag:
      gcr: gcr.io/$PROJECT_ID/aloud